

@{
    ViewBag.Title = "HandleEdit";
    Layout = "~/Views/Shared/Template.cshtml";
}

@model dynamic

<div class="content-wrapper" style=" background-color: white; ">
    <!-- Content Header (Page header) -->
    <div class="content-header">
        <div class="container-fluid">
            <div class="row mb-2 mt-15">
                <div class="col-sm-6">

                    <ol class="breadcrumb float-sm-left edit2">

                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active"><a href="/Admin">Quản lí câu hỏi</a></li>
                        <li class="breadcrumb-item active">Cập nhật câu hỏi</li>
                    </ol>
                </div><!-- /.col -->
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <button type="button" class="btn btn-light">
                            <a href="~/Admin">
                                <i class="fa fa-reply"></i>Quay lại
                            </a>
                        </button>

                        <!--test-->
                        <!-- The Modal -->
                        <div class="modal" id="myModal">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                    <!-- Modal Header -->
                                    <div class="modal-header">
                                        <h4 class="modal-title">Chọn loại câu hỏi</h4>
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    </div>

                                    <!-- Modal body -->
                                    <div class="modal-body">

                                    </div>

                                    <!-- Modal footer -->
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-success">
                                            <a href="/Admin/AddQuestion" style="color:white;">Thêm Mới</a>

                                        </button>
                                        <button type="button" class="btn btn-danger" data-dismiss="modal">Đóng</button>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <!--test-->
                    </ol>
                </div><!-- /.col -->
            </div><!-- /.row -->
            <hr / style="width:100%;border:2px solid #d2d6de">
            <div class="container-fluid">
                @using (Html.BeginForm("", "Admin", FormMethod.Post, new { enctype = "multipart/form-data", id = "formdataEdit" }))
                {
                    @*<form method="post" action="/Admin/AddData" enctype="multipart/form-data">*@
                    @Html.AntiForgeryToken()

                    <div class="row" style="display:none">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <input value="@Model.question.ID_Type" class="form-control input-icon valid" id="maloaich2" name="maloaich" type="text" readonly aria-required="true" aria-invalid="false" aria-describedby="CodeQuestion-error" required>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">
                            <input value="@Model.question.Name_Type" class="form-control input-icon valid" id="tenloaich2" name="tenloaich" type="text" readonly aria-required="true" aria-invalid="false" aria-describedby="CodeQuestion-error" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Mã câu hỏi &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">
                            <input class="form-control input-icon valid" id="codeupdate" name="mch" placeholder="Mã câu hỏi" type="text" readonly aria-required="true"
                                   value="@Model.question.ID_Cauhoi" aria-invalid="false" aria-describedby="CodeQuestion-error" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Danh mục &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">

                            <div>
                                <div>
                                    <select class="custom-select" id="namedm2" name="namedm2">

                                        @foreach (var item in Model.list_dm)
                                        {
                                            if (item.ID_DM == Model.question.ID_DM)
                                            {
                                                <option value="@item.ID_DM" selected>@item.NameDM</option>

                                            }
                                            else
                                            {
                                                <option value="@item.ID_DM">@item.NameDM</option>
                                            }

                                        }



                                    </select>

                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Đơn vị &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">
                            <select class="custom-select" id="namedv2" name="namedv2">

                                @foreach (var item in Model.list_dv)
                                {

                                    if (item.ID_DV == Model.question.ID_DV)
                                    {
                                        <option value="@item.ID_DV" selected>@item.NameDV</option>

                                    }
                                    else
                                    {
                                        <option value="@item.ID_DV">@item.NameDV</option>
                                    }
                                }



                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Môn thi &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">
                            <select class="custom-select" id="namemt2" name="namemt2">

                                @foreach (var item in Model.list_mt)
                                {

                                    if (item.ID_MT == Model.question.ID_MT)
                                    {
                                        <option value="@item.ID_MT" selected>@item.Name_MT</option>

                                    }
                                    else
                                    {
                                        <option value="@item.ID_MT">@item.Name_MT</option>
                                    }

                                }



                            </select>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Nội dung câu hỏi &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">

                            <textarea name="descriptionupdate" id="descriptionupdate" rows="10" cols="80" required>@Model.question.Content_QS</textarea>
                           
                            <span id="error_question2" style="color:red; margin-left:5px"></span>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Upload File &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">
                            <div class="row">
                                <div class="col-lg-4">
                                    <input type="file" id="uploadfileupdate" name="uploadfileupdate" class="form-control" style="border:none;overflow: hidden;" onchange="ChooseFile2()">
                                </div>
                                <div class="col-lg-8">
                                    <button type="button" value="UploadFile" class="btn green" id="UploadFile2"
                                            style=" color: #fff; background-color: #35aa47; border-color: #35aa47;margin-left: 15px;" onclick="xuliUpfileEdit()">
                                        <i class="fas fa-upload"></i> UploadFile
                                    </button>
                                </div>
                                
                            </div>

                            <span id="error_file2" style="color:red; margin-left:5px"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Link Video &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">

                            <input type="text" id="linkvideoupdate" name="linkvideo" class="form-control col-sm-9"
                                   value="@Model.question.UrlFile">
                            <span id="error_urlvideo2" style="color:red; margin-left:5px"></span>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Mức độ &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">
                            <select class="custom-select" id="levelquestionupdate">
                                @if (Model.question.Level_Question == "Dễ")
                                {
                                    <option value="1" selected> Dễ</option>
                                    <option value="2">Khó</option>
                                }
                                else
                                {
                                    <option value="1"> Dễ</option>
                                    <option value="2" selected>Khó</option>
                                }

                            </select>

                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Ngày hết hạn &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">
                            <input id="datepickerupdate" width="276" required name="enddate" placeholder="dd/mm/yyyy" value="@Model.question.EndDate"
                                   readonly="true" />
                            <span id="error_dateUpdate" style="color:red; margin-left:5px"></span>
                        </div>
                    </div>



                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Nội dung câu trả lời &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">

                            <textarea name="cautl_update" id="cautl_update" rows="10" cols="80" required>
                              
                            </textarea>
                            <script language="javascript">
                                CKEDITOR.replace('cautl_update', {
                                    entities_latin: false,
                                    entities_greek: false
                                });


                            </script>
                            <span id="error_answerUpdate" style="color:red; margin-left:5px"></span>

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Giải thích &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">

                            <textarea name="explainupdate" id="explainupdate" rows="10" cols="80" required></textarea>
                            <script language="javascript">
                                CKEDITOR.replace('explainupdate', {
                                    entities_latin: false,
                                    entities_greek: false
                                });
                            </script>
                            <span id="error_explainUpdate" style="color:red; margin-left:5px"></span>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-3" style="border: 1px solid #d2d6de; border-top:none; ">
                            <label class="float-sm-right" style="padding:15px;">Loại câu trả lời &nbsp; <span style="color:red;">*</span></label>
                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border-top:none; border-left:none;padding-top:10px;">
                            <select class="custom-select" id="type_AsUpdate" name="type_AsUpdate" onchange="ChangeSelect()">
                                @if (Model.question.TypeQuestion == 2)
                                {
                                    <option value="1">Một đáp án đúng</option>
                                    <option value="2" selected>Nhiều đáp án đúng</option>
                                }
                                else
                                {
                                    <option value="1" selected>Một đáp án đúng</option>
                                    <option value="2">Nhiều đáp án đúng</option>

                                }

                            </select>

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3" style=" border:none">

                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border:none;padding-top:10px;">
                            <button type="button" class="btn btn-success" onclick="handleAddAnswer2()" id="txtAddAs2">Thêm câu trả lời</button>
                            <span id="showerrorUpdate" style="color:red; margin-left:5px"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3" style=" border:none">

                        </div>
                        <div class="col-sm-9" style="border: 1px solid #d2d6de; border:none;padding-top:10px;">
                            <table id="tableques" class="table">
                                <thead class="thead-light">
                                    <tr class="row">
                                        <th scope="col" class="col-lg-2">ID</th>
                                        <th scope="col" class="col-lg-4">Nội dung câu trả lời</th>
                                        <th scope="col" class="col-lg-4">Giải thích</th>
                                        <th scope="col" class="col-lg-2">Hành động</th>
                                    </tr>
                                </thead>
                                <tbody id="tableAnswerUpdate">
                                </tbody>
                            </table>
                        </div>
                    </div>

                }

                <div class="row">
                    <div class="col-sm-3" style=" border:none">

                    </div>
                    <div class="col-sm-9" style="border: 1px solid #d2d6de; border:none;padding-top:10px;">
                        <button type="button" class="btn btn-success" onclick="submit_update()" id="ButtonUpdate">Cập nhật</button>
                        <span id="showerrorUpdate2" style="color:red; margin-left:5px"></span>
                    </div>
                </div>
            </div>

        </div>
    </div>

</div>

<script>


    var list_ans = @Html.Raw(Json.Encode(Model.answer))
        console.log(list_ans);

</script>
<script src="~/Scripts/Customize/HandleEdit.js"></script>


